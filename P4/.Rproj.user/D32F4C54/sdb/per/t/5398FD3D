{
    "contents" : "---\noutput: pdf_document\n---\nWineQuality by Rui Maranhao\n========================================================\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, packages}\n# Loading all packages \n#install.packages(\"ggplot2\", dependencies = T) \n#install.packages(\"knitr\", dependencies = T)\n#install.packages(\"dplyr\", dependencies = T)\n#install.packages(\"RColorBrewer\", dependencies = T)\n\nlibrary(ggplot2)\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(RColorBrewer) \nlibrary(gridExtra)\n```\n\n```{r echo=FALSE, Load_the_Data}\n# Load the Data\nwine <- read.csv(\"wineQualityReds.csv\")\n```\n\n# Summary Statistics\n```{r echo=FALSE, Statis}\n\ndim(wine)\ncolnames(wine)\nstr(wine)\nsummary(wine)\n\nsummary(wine$quality)\ntable(wine$quality)\n\nwine$qualOrig <- wine$quality #used in regression\nwine$quality <- factor(wine$quality, ordered = T)\nstr(wine$quality)\nlevels(wine$quality)\n```\n\nMore information regarding wines [Cortez et al., 2009]. Input variables (based on physicochemical tests):\n\n- fixed acidity (tartaric acid - g / dm^3)\n\n- volatile acidity (acetic acid - g / dm^3)\n\n- citric acid (g / dm^3)\n\n- residual sugar (g / dm^3)\n\n- chlorides (sodium chloride - g / dm^3\n\n- free sulfur dioxide (mg / dm^3)\n\n- total sulfur dioxide (mg / dm^3)\n\n- density (g / cm^3)\n\n- pH\n\n- sulphates (potassium sulphate - g / dm^3)\n\n- alcohol (% by volume)\n\n- quality (score between 0 and 10)\n\n# Univariate Plots Section\n\nPloting all variables but X (which appears to be an unique identifier) to get the feeling about the distribution of the values. \n\n```{r echo=FALSE, Univariate_Plots}\n\n# exploratory, quick histogram plots\ngrid.arrange(qplot(wine$fixed.acidity),\n             qplot(wine$volatile.acidity),\n             qplot(wine$citric.acid),\n             qplot(wine$residual.sugar),\n             qplot(wine$chlorides),\n             qplot(wine$free.sulfur.dioxide),\n             qplot(wine$total.sulfur.dioxide),\n             qplot(wine$density),\n             qplot(wine$pH),\n             qplot(wine$sulphates),\n             qplot(wine$alcohol),\n             qplot(wine$quality),\n             ncol = 4)\n```\n\n# Univariate Analysis\n\n### What is the structure of your dataset?\n\nThere are 1599 observations of 13 numeric variables.\n\n### What is/are the main feature(s) of interest in your dataset?\n\nThe first feature of interest is the wine quality. The range of the wine quality is between 3 and 8, being 6.0 the median quality 6.0. A vast majority of the wines have a rating of either 5 or 6. \n\nI have decided to instantiate a categorical variable rating wines qualitatively as bad, average, and good. One can see that most wines have been rated as average. \n\n```{r echo=FALSE, ExtraUnivariate_Plots}\nwine$rating <- ifelse(wine$quality < 5, 'bad', ifelse(wine$quality < 7, 'average', 'good'))\nwine$rating <- ordered(wine$rating, levels = c('bad', 'average', 'good'))\n#summary(wine$rating)\nqplot(wine$rating)\n```\n\nSecond, I investigated the citric acid because I noticed that there are many observations that equal 0 in the dataset (132 observations to be precise). According to me this would require further investigation to find out whether this values were properly reported.\n\n```{r echo=FALSE, Citric}\nlength(subset(wine, citric.acid == 0)$citric.acid)\n```\n\nOther variables of interest are pH and densitiy as they seem to be normally distributed. Alcohol and total/free sulphur dioxide look to have a long tail and being skewed towards 0.\n\n### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?\n\nI think further investigation wether pH could be classified into categorial (acid, base, neutral) could potentially be of interest. Also the relationship between fixed.acidity, volatile.acidity, and citric.acid (in particular this one due to the large number of 0s) could be interesting to further investigate in order to understand if the values are properly reported. This would require to understand the theoretical relationship between these variables.\n\n### Did you create any new variables from existing variables in the dataset?\n\nI only created the variable (ordered factor) rating to classify wine as good, bad or average. The information that the other variables store there does not seem to be any other variable that would fit well a sub-classification into categorical variables, perhaps with the exception of residual pH (neutral, base, acid). \n\n### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?\n\nI've not found the need to tidy, adjust, or change the form of the data. \n\nI've discussed the distributions in the section about the features of interest.\n\nBelow I use boxplots to gain a better understanding wrt. outliers (except for X for being an index, and quality for being categorical). I've also plotted the data using a log10 scale (I plotted for all variables, although only those with long tails are interesting for the log10 scale). These plots have shown that fixed acidity and to some extent pH, chlorides, densitiy, sulphates, volatile acidity to follow a normal distribution. As for the acidity variables, this is aligned with the fact that pH seems to be normally distributed, apart from the citric acid. The reason for the latter might be the number of 0 (potentially non-responses) discussed earlier. pH is normally distribution which suggests that the data is good, since by definition it is a measure of acidity and is on a logarithmic scale. \n\n```{r echo=FALSE, Outliers}\n#ggplot(wine, aes(x = 'simple', y = wine$pH, xlab = '', ylab = 'pH')) + geom_boxplot()\n\n#plot all boxplots\ngrid.arrange(ggplot(stack(wine[,2:7]), aes(x = ind, y = values)) + geom_boxplot(),\n             ggplot(stack(wine[,8:12]), aes(x = ind, y = values)) + geom_boxplot())\n\n#with coord_trans it would crash\ngrid.arrange(ggplot(aes(x = fixed.acidity), data = wine) + geom_histogram() + coord_trans(x = \"log10\"),\n             ggplot(aes(x = volatile.acidity), data = wine) + geom_histogram() + coord_trans(x = \"log10\"),\n             ggplot(aes(x = citric.acid), data = wine) + geom_histogram() + scale_x_log10(),\n             ggplot(aes(x = residual.sugar), data = wine) + geom_histogram() + scale_x_log10(),\n             ggplot(aes(x = chlorides), data = wine) + geom_histogram() + scale_x_log10(),\n             ggplot(aes(x = free.sulfur.dioxide), data = wine) + geom_histogram() + scale_x_log10(),\n             ggplot(aes(x = total.sulfur.dioxide), data = wine) + geom_histogram() + scale_x_log10(),\n             ggplot(aes(x = density), data = wine) + geom_histogram() + scale_x_log10(),\n             ggplot(aes(x = pH), data = wine) + geom_histogram() + scale_x_log10(),\n             ggplot(aes(x = sulphates), data = wine) + geom_histogram() + scale_x_log10(),\n             ggplot(aes(x = alcohol), data = wine) + geom_histogram() + scale_x_log10())\n```\n\n# Bivariate Plots Section\n```{r echo=FALSE, Bivariate_Plots}\ngrid.arrange(ggplot(aes(x = quality, y = fixed.acidity), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = volatile.acidity), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = citric.acid), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = residual.sugar), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = chlorides), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = free.sulfur.dioxide), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = total.sulfur.dioxide), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = density), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = pH), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = sulphates), data = wine) + geom_point(alpha = 1/20),\n             ggplot(aes(x = quality, y = alcohol), data = wine) + geom_point(alpha = 1/20))\n             \ngrid.arrange(ggplot(aes(x = rating, y = fixed.acidity), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = volatile.acidity), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = citric.acid), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = residual.sugar), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = chlorides), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = free.sulfur.dioxide), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = total.sulfur.dioxide), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = density), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = pH), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = sulphates), data = wine) + geom_jitter(alpha = 1/20),\n             ggplot(aes(x = rating, y = alcohol), data = wine) + geom_jitter(alpha = 1/20))             \n\n#coord_trans(x = \"log10\")\n```\n\n# Bivariate Analysis\n\n### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?\n\nIt looks like the following characteristics yields 'good' wines:\n\n- Acitiy: higher fixed acitity and citric acid; lower volative acitity;\n- Lower pH (~3.5)\n- Higher sulphtes\n- Higher alcohol\n\nIt looks like the following yields 'average'/'good' wines:\n\n- Sulfur dioxide: higher free and total sulfur dioxide\n- Lower density\n\nResidual sugar and chlorides did not seem to have an impact on the quality or rating of the wines. \n\n### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?\n\nI studied the relationship between the variables that correlate the most with quality: citric acid, sulphates, alcohol, and volatile acidity (see next question).\n\nAppart from the higher the alchol the better the wine, the Pearson's test revealed that volatile aciditity and citric acid have a strong negative correlation.\n\n```{r echo=FALSE, CorrelationsCompPlots}\nwith(wine, cor.test(citric.acid, alcohol))\nwith(wine, cor.test(sulphates, alcohol))\nwith(wine, cor.test(volatile.acidity, alcohol))\nwith(wine, cor.test(sulphates, citric.acid))\nwith(wine, cor.test(sulphates, volatile.acidity))\nwith(wine, cor.test(volatile.acidity, citric.acid))\n```\n\n### What was the strongest relationship you found?\n\nThe quality shows the strongest correlation with alcohol (0.4761663). Note that there is also a negative strong correlation with volatile acidity (-0.3905578), and sulphates and alcohol show the weakest bi-variate relationship.\n\n```{r echo=FALSE, Correlations}\nwith(wine, cor.test(fixed.acidity, as.numeric(quality)))\nwith(wine, cor.test(volatile.acidity, as.numeric(quality)))\nwith(wine, cor.test(citric.acid, as.numeric(quality)))\nwith(wine, cor.test(residual.sugar, as.numeric(quality)))\nwith(wine, cor.test(chlorides, as.numeric(quality)))\nwith(wine, cor.test(free.sulfur.dioxide, as.numeric(quality)))\nwith(wine, cor.test(total.sulfur.dioxide, as.numeric(quality)))\nwith(wine, cor.test(density, as.numeric(quality)))\nwith(wine, cor.test(pH, as.numeric(quality)))\nwith(wine, cor.test(sulphates, as.numeric(quality)))\nwith(wine, cor.test(alcohol, as.numeric(quality)))\n```\n\n# Multivariate Plots Section\n\n```{r echo=FALSE, Multivariate_Plots}\nggplot(data = wine, aes(x = citric.acid, y = alcohol, color = quality)) + facet_wrap(~rating) + geom_point()\nggplot(data = wine, aes(x = sulphates, y = alcohol, color = quality)) + facet_wrap(~rating) + geom_point()\nggplot(data = wine, aes(x = volatile.acidity, y = alcohol, color = quality)) + facet_wrap(~rating) + geom_point()\nggplot(data = wine, aes(x = sulphates, y = citric.acid, color = quality)) + facet_wrap(~rating) + geom_point()\nggplot(data = wine, aes(x = sulphates, y = volatile.acidity, color = quality)) + facet_wrap(~rating) + geom_point()\nggplot(data = wine, aes(x = volatile.acidity, y = citric.acid, color = quality)) + facet_wrap(~rating) + geom_point()\nggplot(data = wine, aes(x = pH, y = alcohol, color = quality)) + geom_point() + facet_wrap(~rating)\n#ggplot(data = wine, aes(x = pH, y = log10(citric.acid), color = quality)) + geom_point() + facet_wrap(~rating)\n#ggplot(data = wine, aes(x = pH, y = log10(volatile.acidity), color = quality)) + geom_point() + facet_wrap(~rating)\n#ggplot(data = wine, aes(x = pH, y = log10(fixed.acidity), color = quality)) + geom_point() + facet_wrap(~rating)\n```\n\n# Multivariate Analysis\n\n### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?\n\nI focused on the 4 features that showed strong correlation with quality, plus pH. The plots show that a higher citric acid, higher sulphates, higher alchohol, and lower volatile acid are key factors to achieve a high quality wine. \n\n### Were there any interesting or surprising interactions between features?\n\npH does not seem to have a high impact on wine quality, despite the fact that the acids do play a role.\n\n### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.\n\nI've created a model to predict the quality of wine given its alcohol. I did this because alcohol has revealed to have strong correlation with quality. The linear model didn't work well in practice. I think the main reason is because quality is a categorical value, hence not very suitable to linear models. It might be the case it is possible to predict pH from the acids. \n\n```{r echo=FALSE, predictions_model}\nm <- lm(I(as.numeric(qualOrig)) ~ I(alcohol), data = wine)\nwine$quality.predictions <- predict(m, wine)\nwine$quality.predictions <- round(wine$quality.predictions,0) \n\n# error = (observed - expected) / expected\nwine$quality.error <- (wine$quality.predictions - wine$qualOrig)/wine$qualOrig\n\n#wine$quality.error\nggplot(data = wine, aes(x = quality, y = quality.error)) + geom_boxplot()\n```\n------\n\n# Final Plots and Summary\n\n### Plot One\n```{r echo=FALSE, Plot_One}\ngrid.arrange(ggplot(data = wine, aes(x = quality, y = fixed.acidity,\n                                   fill = quality)) + \n               ylab('Fixed Acidity (g/dm^3)') +\n               xlab('Quality') +\n               geom_boxplot(),\n             ggplot(data = wine, aes(x = quality, y = volatile.acidity,\n                                   fill = quality)) +\n               ylab('Volatile Acidity (g/dm^3)') +\n               xlab('Quality') +\n               geom_boxplot(), \n             ggplot(data = wine, aes(x = quality, y = citric.acid,\n                                   fill = quality)) +\n               ylab('Citric Acid (g/dm^3)') +\n               xlab('Quality') +\n               geom_boxplot(), \n             ggplot(data = wine, aes(x = quality, y = pH,\n                                   fill = quality)) +\n               ylab('pH') +\n               xlab('Quality') +\n               geom_boxplot())\n```\n\n### Description One\nThese plots show the effect of acidity and pH on wine quality: higher acidity (hence, lower pH), apart from the volatile acid, is shown to yield better wines. The impact of fixed acid on quality is marginal. \n\n### Plot Two\n```{r echo=FALSE, Plot_Two}\nggplot(data = wine, aes(x = quality, y = alcohol, fill = rating)) +\n  geom_boxplot() +\n  ggtitle('Alcohol Levels in Different Wine Qualities') +\n  xlab('Quality') +\n  ylab('Alcohol (% volume)')\n\nggplot(data = wine, aes(x = quality, y = sulphates, fill = rating)) +\n  geom_boxplot() +\n  ggtitle('sulphates Levels in Different Wine Qualities') +\n  xlab('Quality') +\n  ylab('sulphates (g / dm^3)')\n```\n\n### Description Two\nThese plots show the effect of alcohol on wine quality: higher alcohol, better wines. The same trend is observed of sulphates. \n\n### Plot Three\n```{r echo=FALSE, Plot_Three}\nggplot(data = wine, aes(x = residual.sugar, y = alcohol) )+\n       facet_wrap(~rating) +\n       geom_boxplot() +\n       xlab('Residual sugar (g / dm^3') +\n       ylab('Alcohol (% volume)') +\n       ggtitle('residual sugar vs. Alcohol correlation by Quality')\n```\n\n### Description Three\n\nThis plot shows the the correlation betwwen quality and residual sugar vs. alcohol. The plot suggests that higher alcohol levels and lower residual sugars levels imply better red wines.\n\n------\n\n# Reflection\n\nThe study about wine wines has revealed the following:\n\n- Most wines in the dataset are rated as 'average', just a small number of wines are rated as 'bad'.\n\n- There might be a problem with the citric acid, as there are many entries set to 0. \n\n- Higher alchold positively impact the rating of the wines (i.e., better wines).\n\n- More alcohol and low residual sugars yield to good red wines. [My intuition tells me that this might be different for white wines!]\n\n- Residual sugar and chlorides did not seem to have an impact on the quality or rating of the wines.\n\n- The lower volatile acidity the better the wine (string negative correlation)\n\nGiven that only alcohol correlated with quality of wine, this may suggest that rating a wine is not subject to the objectivity of the exports. There might also be the case that there are other factors which are not represented in the dataset (vintage, harvest year, location of the vineyards, temperatures before harvesting the wine, etc). Trying to obtain this information would be interesting for further exploration. Confirming this results using the white wine dataset woud also be of particular interest to me. \n\n# References\n\nP. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis. Modeling wine preferences by data mining from physicochemical properties. In Decision Support Systems, Elsevier, 47(4):547-553. ISSN: 0167-9236.",
    "created" : 1453257335877.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "165636485",
    "id" : "5398FD3D",
    "lastKnownWriteTime" : 1453260150,
    "path" : "~/Desktop/Nanodegree DS/projects/P4/projectTemplate.Rmd",
    "project_path" : "projectTemplate.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}