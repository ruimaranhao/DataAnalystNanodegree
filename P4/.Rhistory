pwd
beer1 <- read_csv('beer.dat', header=TRUE)
beer1 <- 1
beer1 <- read.csv("~/Downloads/beer.dat", sep="")
View(beer1)
plot(beer1, type="l")
plot(beer1)
beer1 <- read.csv("~/Downloads/beer.dat", sep="")
plot(beer1, type="l")
beer1 <- read.csv("~/Downloads/beer.dat", header=TRUE)
beer1 <- read.csv("~/Downloads/beer.dat", header=TRUE)
View(beer1)
beer1 <- read.csv(file.choose(), header=TRUE)
plot(beer1, type="l")
plot(beer1, type="1")
plot(beer1, type="t")
beer1 <- read.csv(file.choose(), header=TRUE)
plot(beer1, type="t")
plot(beer1)
plot(beer1)
plot(beer1, type="t")
beer1 <- read.csv(file.choose(), header=TRUE)
beer1 <- read.csv(file.choose(), header=TRUE)
plot(beer1, type="t")
install.packages("ggplot2", dependencies = T)
install.packages("knitr", dependencies = T)
install.packages("dplyr", dependencies = T)
setwd('/Users/maranhao/Desktop/Nanodegree DS/projects/P4')
load("~/Desktop/Nanodegree DS/projects/P4/analysis.R")
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
?table
str(wine)
?str
level(wine)
levels(wine)
levels(wine$quality)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
ggplot(data=wine, x = quality)
ggplot(data=wine, x = quality)
source('~/.active-rstudio-document', echo=TRUE)
dim(wine)
head(wine)
colnames(wine)
colnames(wine)
summary(wine)
table(wine$quality)
str(wine)
str(wine)
summary(wine)
source('~/.active-rstudio-document', echo=TRUE)
summary(wine$quality)
```{r echo=FALSE, Statis}
dim(wine)
colnames(wine)
str(wine)
summary(wine)
summary(wine$quality)
table(wine$quality)
df$quality <- factor(df$quality, ordered = T)
df$quality <- factor(wine$quality, ordered = T)
win$quality <- factor(wine$quality, ordered = T)
win$quality <- factor(wine$quality, ordered = T)
wine$quality <- factor(wine$quality, ordered = T)
str(wine$quality)
levels(wine$quality)
ncol = 2)
grid.arrange(qplot(wine$fixed.acidity),
wine$rating <- ifelse(wine$quality < 5, 'bad', ifelse(wine$quality < 7, 'average', 'good'))
wine$rating <- ordered(df$rating, levels = c('bad', 'average', 'good'))
wine$rating <- ifelse(wine$quality < 5, 'bad', ifelse(wine$quality < 7, 'average', 'good'))
wine$rating <- ordered(df$rating, levels = c('bad', 'average', 'good'))
```{r echo=FALSE, Univariate_Plots}
wine$rating <- ifelse(wine$quality < 5, 'bad', ifelse(wine$quality < 7, 'average', 'good'))
wine$rating <- ordered(wine$rating, levels = c('bad', 'average', 'good'))
summary(wine$rating)
wine$rating <- ifelse(wine$quality < 5, 'bad', ifelse(wine$quality < 7, 'average', 'good'))
wine$rating <- ordered(wine$rating, levels = c('bad', 'average', 'good'))
summary(wine$rating)
qplot(wine$rating)
```{r echo=FALSE, Citric}
length(subset(wine, citric.acid == 0)$citric.acid)
library(ggplot2)
get_simple_boxplot(wine$fixed.acidity, 'fixed acidity')
get_simple_boxplot <- function(column, ylab) {
return(qplot(data = df, x = 'simple',
y = column, geom = 'boxplot',
xlab = '',
ylab = ylab))
}
get_simple_boxplot(wine$fixed.acidity, 'fixed acidity')
qplot(data = wine$quality, x = 'simple',
y = column, geom = 'boxplot',
xlab = '',
ylab = ylab))
qplot(data = wine$quality, x = 'simple',
y = column, geom = 'boxplot',
xlab = '',
ylab = ylab)
qplot(data = wine$pH, x = 'simple',
y = column, geom = 'boxplot',
xlab = '',
ylab = ylab)
#grid.arrange(get_simple_boxplot(wine$fixed.acidity, 'fixed acidity'),
#grid.arrange(get_simple_boxplot(wine$fixed.acidity, 'fixed acidity'),
qplot(data = wine$pH, x = 'simple',
y = column, geom = 'boxplot',
xlab = '',
ylab = ylab)
get_simple_boxplot(wine$fixed.acidity, 'fixed acidity')
qplot(data = wine, x = 'simple',
y = fixed_acitidy, geom = 'boxplot',
xlab = '',
ylab = ylab)
qplot(data = wine, x = 'simple',
y = fixed.acitidy, geom = 'boxplot',
xlab = '',
ylab = ylab)
#grid.arrange(get_simple_boxplot(wine$fixed.acidity, 'fixed acidity'),
#             get_simple_boxplot(wine$volatile.acidity, 'volatile acidity'),
qplot(data = wine, x = 'simple', y = wine$fixed.acitidy, geom = 'boxplot')
gglot(data = wine, x = 'simple', y = wine$fixed.acitidy, geom = 'boxplot')
ggplot(wine, aes(x = factor(pH))) + geom_bar(stat = "bin")
ggplot(wine, aes(x = factor(density))) + geom_bar(stat = "bin")
ggplot(wine, aes(x = factor(quality))) + geom_bar(stat = "bin")
table(wine$pH)
?table
qplot(data = wine$pH, fill=variable,
data=means, geom="bar", stat="identity",
position="dodge")
qplot(data = wine$pH, fill=variable, geom="boxplot", stat="identity", position="dodge")
qplot(data = wine$pH, fill=variable, geom="boxplot")
qplot(data = wine, fill=variable, geom="boxplot")
qplot(data = wine, geom="boxplot")
qplot(data = wine, y=wine$pH geom="boxplot")
qplot(data = wine, y=wine$pH, geom="boxplot")
ggplot(stack(wine), aes(x = ind, y = values)) + geom_boxplot())
ggplot(stack(wine), aes(x = ind, y = values)) + geom_boxplot()
stack(wine)
ggplot(wine, aes(x = ind, y = values)) + geom_boxplot()
head(stack(wine))
stack(wine)
head(stack(wine))
stack(wine)
ggplot(wine, aes(x = wine$pH, y = wine$pH)) + geom_boxplot()
ggplot(wine, aes(x = wine$pH, y = wine$pH, ylab = ' ')) + geom_boxplot()
ggplot(wine, aes(x = wine$pH, y = wine$pH, xlab = ' ')) + geom_boxplot()
ggplot(wine, aes(x = wine$pH, y = wine$pH, xlab = ' ')) + geom_boxplot()
xlab = ' '
ggplot(wine, aes(x = 'simple', y = wine$pH, xlab = ' ')) + geom_boxplot()
ggplot(wine, aes(x = 'simple', y = wine$pH)) + geom_boxplot()
ggplot(wine, aes(x = 'simple', y = wine$pH)) + geom_boxplot()
ggplot(wine, aes(x = 'simple', y = wine$pH, xlab = '', ylab = 'pH')) + geom_boxplot()
ggplot(wine, x = 'simple', y = wine$pH, xlab = '', ylab = 'pH') + geom_boxplot()
aes(
#ggplot(stack(df), aes(x = ind, y = values)) + geom_boxplot()
ggplot(wine, aes(x = 'simple', y = wine$pH, xlab = '', ylab = 'pH')) + geom_boxplot()
#plot all boxplots
#ggplot(stack(df), aes(x = ind, y = values)) + geom_boxplot()
ggplot(stack(df), aes(x = ind, y = values)) + geom_boxplot()
ggplot(stack(df), aes(x = ind, y = values)) + geom_boxplot()
#plot all boxplots
ggplot(stack(wine), aes(x = ind, y = values)) + geom_boxplot()
ggplot(stack(wine[7:13]), aes(x = ind, y = values)) + geom_boxplot()
grid.arrange(ggplot(stack(wine[1:6]), aes(x = ind, y = values)) + geom_boxplot(),
ggplot(stack(wine[7:13]), aes(x = ind, y = values)) + geom_boxplot())
```
stack(wine[2:6,])
stack(wine[,2:6])
stack(wine[,2:6])
stack(wine[,7:13])
stack(wine[,7:14])
ggplot(stack(wine[,7:14]), aes(x = ind, y = values)) + geom_boxplot())
wine[,13:14]
wine[,13]
ggplot(stack(wine[,7:13]), aes(x = ind, y = values)) + geom_boxplot())
ggplot(aes(x = wine$quality, y = wine$alcohol)) + geom_point() + xlim(13, 90)
ggplot(aes(x = quality, y = alcohol, data = wine)) + geom_point() + xlim(13, 90)
library(ggplot2)
library(knitr)
library(dplyr)
library(RColorBrewer)
library(gridExtra)
library(ggplot2)
wine <- read.csv("wineQualityReds.csv")
dim(wine)
colnames(wine)
str(wine)
summary(wine)
ggplot(aes(x = quality, y = alcohol, data = wine)) + geom_point() + xlim(13, 90)
wine$quality
ggplot(x = quality, y = alcohol, data = wine) + geom_point() + xlim(13, 90)
ggplot(aes(x = quality, y = alcohol), data = wine) + geom_point() + xlim(13, 90)
ggplot(aes(x = quality, y = alcohol), data = wine) + geom_point()
colnames(wine)
grid.arrange(ggplot(stack(wine[,2:7]), aes(x = ind, y = values)) + geom_point(),
ggplot(stack(wine[,8:12]), aes(x = ind, y = values)) + geom_point())
grid.arrange(ggplot(aes(x = quality, y = fixed.acitidy), data = wine) + geom_point(),
ggplot(aes(x = quality, y = volatile.acidity), data = wine) + geom_point(),
ggplot(aes(x = quality, y = volatile.acidity), data = wine) + geom_point(),
ggplot(aes(x = quality, y = citric.acid), data = wine) + geom_point(),
ggplot(aes(x = quality, y = residual.sugar), data = wine) + geom_point(),
ggplot(aes(x = quality, y = chlorides), data = wine) + geom_point(),
ggplot(aes(x = quality, y = free.sulfur.dioxide), data = wine) + geom_point(),
ggplot(aes(x = quality, y = total.sulfur.dioxide), data = wine) + geom_point(),
ggplot(aes(x = quality, y = density), data = wine) + geom_point(),
ggplot(aes(x = quality, y = pH), data = wine) + geom_point(),
ggplot(aes(x = quality, y = sulphates), data = wine) + geom_point(),
ggplot(aes(x = quality, y = alcohol), data = wine) + geom_point())
cor.test(wine$fixed.acidity, as.numeric(wine$quality))$estimate
cor.test(wine$fixed.acidity, as.numeric(wine$quality))$estimate
cor.test(wine$volatile.acidity, as.numeric(wine$quality))$estimate
cor.test(wine$citric.acid, as.numeric(wine$quality))$estimate
cor.test(wine$residual.sugar, as.numeric(wine$quality))$estimate
cor.test(wine$chlorides, as.numeric(wine$quality))$estimate
cor.test(wine$free.sulfur.dioxide, as.numeric(wine$quality))$estimate
cor.test(wine$total.sulfur.dioxide, as.numeric(wine$quality))$estimate
cor.test(wine$density, as.numeric(wine$quality))$estimate
cor.test(wine$pH, as.numeric(wine$quality))$estimate
cor.test(wine$sulphates, as.numeric(wine$quality))$estimate
cor.test(wine$alcohol, as.numeric(wine$quality))$estimate
```
?cor.test
with(wine, cor.test(fixed.acidity, quality))
with(wine, cor.test(fixed.acidity, quality))$estimate
with(wine, cor.test(fixed.acidity, quality))$estimate
with(wine, cor.test(volatile.acidity, quality))$estimate
with(wine, cor.test(citric.acid, quality))$estimate
with(wine, cor.test(residual.sugar, quality))$estimate
with(wine, cor.test(chlorides, quality))$estimate
Next, I computed the Perason's correlations of the different variables with wine quality and verified that there is a strong correlation between quality and citric acid,
with(wine, cor.test(free.sulfur.dioxide, quality))$estimate
with(wine, cor.test(total.sulfur.dioxide, quality))$estimate
with(wine, cor.test(density, quality))$estimate
with(wine, cor.test(pH, quality))$estimate
with(wine, cor.test(sulphates, quality))$estimate
with(wine, cor.test(alcohol, quality))$estimate
ggplot(data = wine, aes(x = sulphates, y = alcohol)) +
facet_wrap(~rating) +
geom_point()
```
ggplot(aes(x = rating, y = alcohol), data = wine) + geom_jitter(alpha = 1/20)
library(caret)
install caret
install.packages("caret")
m <- lm(I(quality) ~ I(alcohol), data = wine)
wine$quality.predictions <- predict(m, wine)
wine$quality.predictions
wine$quality.error <- (wine$quality.predictions - wine$quality)/wine$quality
wine$quality.error
ggplot(data = wine, aes(x = quality, y = pH.error)) + geom_boxplot()
wine$quality.predictions <- round(wine$quality.predictions,0)
wine$quality.predictions
wine$quality.error <- (wine$quality.predictions - wine$quality)/wine$quality
m <- lm(I(quality) ~ I(alcohol), data = wine)
wine$quality.predictions <- predict(m, wine)
wine$quality.predictions <- round(wine$quality.predictions,0)
# (observed - expected) / expected
wine$quality.error <- (wine$quality.predictions - wine$quality)/wine$quality
m <- lm(I(as.numeric(quality)) ~ I(alcohol), data = wine)
summary(wine$quality)
View(wine)
that the wine quality increases with alcohol, except for wine quality 5.
